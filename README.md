# Crawler é¡¹ç›®

ä¸€ä¸ªåŸºäºQt 6.9çš„é«˜æ•ˆç½‘é¡µçˆ¬è™«å·¥å…·ï¼Œæ”¯æŒå¹¶è¡Œä»»åŠ¡å¤„ç†ã€æ•°æ®åº“å­˜å‚¨å’ŒSQLæŸ¥è¯¢ã€‚

## ğŸ“‹ é¡¹ç›®ç‰¹æ€§

- **Qt 6 æ¡†æ¶** - ä½¿ç”¨Qt 6.9è¿›è¡ŒGUIå¼€å‘
- **HTTP è¯·æ±‚** - åŸºäºlibcurlåº“å®ç°ç½‘ç»œçˆ¬å–
- **JSON å¤„ç†** - ä½¿ç”¨nlohmann-jsonè¿›è¡Œæ•°æ®è§£æ
- **æ•°æ®åº“æ”¯æŒ** - SQLiteæ•°æ®åº“é›†æˆï¼Œæ”¯æŒä»»åŠ¡å’Œç»“æœå­˜å‚¨
- **å¹¶è¡Œå¤„ç†** - å¤šä»»åŠ¡å¹¶è¡Œçˆ¬å–ï¼Œæé«˜æ•ˆç‡
- **è·¨å¹³å°** - æ”¯æŒWindowsã€Linuxã€macOSç­‰å¹³å°

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
Crawler/
â”œâ”€â”€ main.cpp                 # ç¨‹åºå…¥å£
â”œâ”€â”€ mainwindow.cpp/.h/.ui    # ä¸»çª—å£UI
â”œâ”€â”€ CMakeLists.txt           # CMakeæ„å»ºé…ç½®
â”œâ”€â”€ network/                 # ç½‘ç»œçˆ¬è™«æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ job_crawler.h        # çˆ¬è™«æ•°æ®ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ job_crawler_main.cpp # çˆ¬è™«ä¸»å…¥å£å‡½æ•°
â”‚   â”œâ”€â”€ job_crawler_network.cpp
â”‚   â”œâ”€â”€ job_crawler_parser.cpp
â”‚   â”œâ”€â”€ job_crawler_printer.cpp
â”‚   â””â”€â”€ job_crawler_utils.cpp
â”œâ”€â”€ db/                      # æ•°æ®åº“æ¨¡å—
â”‚   â”œâ”€â”€ sqlinterface.cpp/.h  # SQLæ¥å£ (SQLNSå‘½åç©ºé—´)
â”œâ”€â”€ tasks/                   # ä»»åŠ¡ç®¡ç†å±‚
â”‚   â”œâ”€â”€ sql_task.cpp/.h      # SQLå­˜å‚¨ä»»åŠ¡ (Networkâ†’SQLæ¡¥æ¢)
â”‚   â”œâ”€â”€ internet_task.cpp/.h # ç½‘ç»œçˆ¬å–ä»»åŠ¡ (å°è£…çˆ¬è™«è°ƒç”¨)
â”‚   â””â”€â”€ crawler_task.cpp/.h  # æ€»ä»»åŠ¡åè°ƒå™¨ (InternetTask+SqlTask)
â”œâ”€â”€ constants/               # æ•°æ®ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ network_types.h      # ç½‘ç»œæ¨¡å—æ•°æ®ç»“æ„
â”‚   â””â”€â”€ db_types.h           # æ•°æ®åº“æ¨¡å—æ•°æ®ç»“æ„
â”œâ”€â”€ test/                    # æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ test_job_crawler.cpp
â”‚   â”œâ”€â”€ test_sql.cpp
â”‚   â”œâ”€â”€ test_integration.cpp
â”‚   â”œâ”€â”€ test_crawler_task.cpp
â”‚   â””â”€â”€ test.h
â””â”€â”€ include/                 # ç¬¬ä¸‰æ–¹åº“ (éœ€è¦è‡ªè¡Œè¡¥å……)
    â”œâ”€â”€ curl-8.17.0_5-win64-mingw/
    â””â”€â”€ nlohmann-json-develop/
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œé€šè¿‡ä»»åŠ¡å±‚å®ç°æ¨¡å—é—´çš„è§£è€¦ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CrawlerTask (æ€»åè°ƒå™¨)             â”‚
â”‚  æä¾›: crawlAndStore()è‡ªåŠ¨éå†æ‰€æœ‰ç±»å‹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚             â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚InternetTask â”‚  â”‚  SqlTask    â”‚
       â”‚  (ç½‘ç»œå±‚)   â”‚  â”‚  (å­˜å‚¨å±‚)   â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚job_crawler  â”‚  â”‚SQLInterface â”‚
       â”‚ (çˆ¬è™«æ ¸å¿ƒ)  â”‚  â”‚ (æ•°æ®åº“)    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®æ¥æºä¸SQLå¯¹é½
```

PK: å²—ä½ID (int) data.id
å²—ä½åç§° (char[]) data.jobName
SK: ç±»å‹ID (int) data.recruitType
SK: åœ°åŒºID (int): è‡ªå¢IDï¼ˆè§ä¸‹ï¼‰
SK: TagID (int): è‡ªå¢IDï¼ˆè§ä¸‹ï¼‰
SK: è–ªèµ„æ¡£æ¬¡ID (int): è‡ªè®¾è®¡IDï¼ˆè§ä¸‹ï¼‰

å²—ä½è¦æ±‚ (char[5000]) data.ext.requirements
æœ€é«˜è–ªèµ„ (double) data.salaryMax
æœ€ä½è–ªèµ„ (double) data.salaryMin
åˆ›å»ºæ—¥æœŸ(dateTime) data.createTime
æ›´æ–°æ—¥æœŸ(dateTime) data.updateTime
HRä¸Šæ¬¡çº¿æ—¶é—´(dateTime) data.user.loginTime

PK: å…¬å¸ID data.companyId
å…¬å¸åç§° (char[]) data.user.identity[].companyNameï¼ˆä»…ä»identityåˆ—è¡¨è·å–ï¼Œç¼ºå¤±è§†ä¸ºé”™è¯¯ï¼‰

PK: ç±»å‹ID data.recruitType
ç±»å‹åç§° (char[]):   ï¼ˆå›ºå®šæšä¸¾ï¼Œ1 æ ¡æ‹›ï¼Œ2 å®ä¹ ï¼Œ3 ç¤¾æ‹›ï¼‰

PK: åœ°åŒºID: è‡ªå¢ID
åœ°åŒºåç§°: data.jobCityï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼›åœ¨æ•°æ®åº“ä¾§æŒ‰åç§°æ’å…¥/æŸ¥æ‰¾ï¼Œè¿”å›è‡ªå¢cityId

PK: TagID: è‡ªå¢ID
Tagå†…å®¹ï¼šéå† data.pcTagInfo.jobInfoTagListï¼Œä¼˜å…ˆå– `tag.title`ï¼ˆå…¼å®¹ `content`/`name`ï¼‰ï¼Œå¯¹æ ‡é¢˜è¿›è¡Œå»é‡åæ’å…¥ JobTagï¼ˆINSERT OR IGNOREï¼‰ï¼Œå¹¶è¿”å›å¯¹åº” tagId ç”¨äº JobTagMapping

PK: è–ªèµ„æ¡£æ¬¡ID: è‡ªè®¾è®¡ID
è–ªèµ„ä¸Šé™ (int)ï¼ˆè®¾è®¡é˜¶æ¢¯ï¼ŒæŒ‰Maxä¸ä¸Šé™æ¯”è¾ƒï¼Œé˜ˆå€¼åˆ†ç±»å­˜å‚¨ï¼‰

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Qt | 6.9.2 | GUIæ¡†æ¶ |
| CMake | 3.30.5 | é¡¹ç›®æ„å»º |
| libcurl | 8.17.0 | HTTPè¯·æ±‚ |
| nlohmann-json | - | JSONè§£æ |
| SQLite | - | æ•°æ®åº“ |
| MinGW | 64-bit | C++ç¼–è¯‘å™¨ |

## ğŸ“¦ ä¾èµ–åº“

### å¤–éƒ¨ä¾èµ–
- **libcurl** - ç½‘ç»œHTTPåº“
- **nlohmann-json** - ç°ä»£C++ JSONåº“
- **SQLite** - è½»é‡çº§æ•°æ®åº“

### å†…ç½®æ¨¡å—
- **job_crawler** - çˆ¬è™«æ ¸å¿ƒå®ç°
- **sqlinterface** - æ•°æ®åº“æ“ä½œæ¥å£
- **sqltask** - SQLä»»åŠ¡ç®¡ç†



## ğŸ“š æ¨¡å—è¯´æ˜

### å¸¸é‡å®šä¹‰æ¨¡å— (constants/)
- **network_types.h** - ç½‘ç»œæ¨¡å—æ•°æ®ç»“æ„ï¼ˆ`JobInfo`ã€`MappingData`ã€`DebugLevel`ç­‰ï¼‰
- **db_types.h** - æ•°æ®åº“æ¨¡å—æ•°æ®ç»“æ„ï¼ˆ`SQLNS::JobInfo`ã€`SQLNS::SalaryRange`ç­‰ï¼‰

### ç½‘ç»œçˆ¬è™«æ¨¡å— (network/)
- **job_crawler.h** - çˆ¬è™«æ¥å£å‡½æ•°å£°æ˜ï¼ˆå¼•ç”¨`constants/network_types.h`ï¼‰
- **job_crawler_main.cpp** - çˆ¬è™«ä¸»å…¥å£ï¼ˆèšåˆç½‘ç»œã€è§£æä¸æ‰“å°ï¼‰
- **job_crawler_network.cpp** - ç½‘ç»œè¯·æ±‚å®ç°ï¼ˆlibcurlï¼Œå¯ç”¨SSLé…ç½®ä¸30sè¶…æ—¶ï¼Œé™„å¸¦User-Agentï¼‰
- **job_crawler_parser.cpp** - å“åº”æ•°æ®è§£æï¼ˆæ”¯æŒå¤šç§JSONæ ¼å¼ã€åŸå§‹JSONè°ƒè¯•æ‰“å°ã€å®‰å…¨ç±»å‹è½¬æ¢ï¼‰
- **job_crawler_printer.cpp** - æ•°æ®è¾“å‡ºï¼ˆç»Ÿä¸€ä½¿ç”¨ `qDebug()`ï¼Œè‹±æ–‡æ ‡ç­¾ï¼‰
- **job_crawler_utils.cpp** - å·¥å…·å‡½æ•°ï¼ˆ`print_debug_info`ã€æ—¶é—´æˆ³è½¬æ¢ã€HTMLæ¸…ç†ã€CURLå†™å›è°ƒï¼‰

### æ•°æ®åº“æ¨¡å— (db/)
- **sqlinterface.h/cpp** - SQLæ‰§è¡Œæ¥å£ï¼ˆSQLNSå‘½åç©ºé—´ï¼‰
- æ”¯æŒSQLiteæ•°æ®åº“æ“ä½œï¼Œé‡‡ç”¨INSERT OR IGNOREæ¨¡å¼é¿å…é‡å¤
- æä¾›å²—ä½ã€å…¬å¸ã€åŸå¸‚ã€æ ‡ç­¾ç­‰è¡¨çš„å¢åˆ æŸ¥æ”¹
- å®ç°64ä½jobIdæ”¯æŒï¼Œé¿å…æ•´å‹æº¢å‡º

### ä»»åŠ¡æ¨¡å— (tasks/)
- **crawler_task.h/cpp** - æ€»ä»»åŠ¡åè°ƒå™¨ï¼Œè‡ªåŠ¨éå†æ‰€æœ‰æ‹›è˜ç±»å‹ï¼ˆæ ¡æ‹›/å®ä¹ /ç¤¾æ‹›ï¼‰
- **internet_task.h/cpp** - ç½‘ç»œçˆ¬å–ä»»åŠ¡ï¼Œå°è£…HTTPè¯·æ±‚ä¸JSONè§£æ
- **sql_task.h/cpp** - SQLå­˜å‚¨ä»»åŠ¡ï¼Œè´Ÿè´£æ•°æ®ç±»å‹è½¬æ¢ã€è–ªèµ„æ¡£æ¬¡è®¡ç®—ï¼ˆæ”¯æŒå®ä¹ å…ƒ/å¤©ä¸å…¨èŒK/æœˆï¼‰

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«æµ‹è¯•ä»£ç åœ¨ `test/` ç›®å½•ï¼š
- `test_internet_task.cpp` - ç½‘ç»œçˆ¬å–å•å…ƒæµ‹è¯•
- `test_sql_task.cpp` - SQLä»»åŠ¡/æ˜ å°„ä¸å­˜å‚¨æµ‹è¯•
- `test_crawler_task.cpp` - çˆ¬å–+å­˜å‚¨é›†æˆæµ‹è¯•

è¿è¡Œæµ‹è¯•ï¼š
```bash
cmake --build . --target test
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

## æ›´æ–°æ—¥å¿—

2025å¹´12æœˆ18æ—¥
* Chester: åˆ›å»º `constants/` æ–‡ä»¶å¤¹ç»Ÿä¸€æ•°æ®ç»“æ„å®šä¹‰ï¼›åˆ é™¤ `SalarySlab` è¡¨ï¼Œè–ªèµ„æ¡£æ¬¡ç”±ä»£ç é€»è¾‘å®šä¹‰ã€‚
* Chester: å®ä¹ è–ªèµ„ç‹¬ç«‹è®¡ç®—ï¼ˆå…ƒ/å¤©ï¼‰ï¼›`CrawlerTask` è‡ªåŠ¨éå†æ‰€æœ‰æ‹›è˜ç±»å‹ã€‚

2025å¹´12æœˆ17æ—¥
* Chester: æ–°å¢HTMLæ ‡ç­¾æ¸…ç†ï¼›`requirements` å­—æ®µæ‰©å®¹è‡³5000å­—ç¬¦ã€‚
* Chester: æ”¯æŒæ–°JSONæ ¼å¼ï¼ˆ`jobTitle`/`city`/`extraInfo`/é¡¶å±‚å…¬å¸å­—æ®µï¼‰ã€‚

2025å¹´12æœˆ16æ—¥
* Chester: æ—¥å¿—ç»Ÿä¸€ä¸º `qDebug()` è‹±æ–‡æ ‡ç­¾ï¼›æ¸…ç†è¿‡æ—¶æ–‡ä»¶ï¼Œæ˜ç¡®æ¨¡å—è¾¹ç•Œã€‚
* Chester: è§„èŒƒæ•°æ®æ˜ å°„ï¼šåŸå¸‚æŒ‰åç§°è‡ªå¢ï¼Œå…¬å¸ä» `identity[]` è·å–ï¼Œæ ‡ç­¾å– `title` å»é‡ï¼›ä¿®å¤æ—¶é—´æˆ³æº¢å‡ºã€‚

2025å¹´12æœˆ14æ—¥
* ç¨‹åºå‘˜A: å®ç°ç½‘ç»œé€šè®¯éƒ¨åˆ†ç¼–å†™ä¸å•å…ƒæµ‹è¯•ã€‚
* Chester: å®Œæˆæ•°æ®åº“å•å…ƒæµ‹è¯•ä¸é¡¹ç›®æ•´åˆã€‚

2025å¹´12æœˆ13æ—¥
* Chester: å®Œæˆæ•°æ®åº“éƒ¨åˆ†åˆæ­¥ç¼–å†™ã€‚
* ç¨‹åºå‘˜A: è°ƒæ•´è¯·æ±‚å¤´ï¼›å¼•å…¥éšæœºæ—¶é—´æˆ³ï¼›å®ç°JSONè‡ªåŠ¨è§£æä¸æ˜ å°„ã€‚




## ä»»åŠ¡æŒ‡å— FaIL
1. ç¬¬ä¸€æ­¥
queryAllJobs()

=====  QVector ç­‰ä»·äº é«˜çº§æ•°ç»„
-Job1 {}
-Job2 {}
-Job3 {}
-Job4 {}
....
=====


2. ç¬¬äºŒæ­¥
=====  QVector ç­‰ä»·äº é«˜çº§æ•°ç»„
-Job1 {}
-Job2 {}
-Job3 {}
-Job4 {}
....
===== åˆå§‹

â†“

==== QVector 
       ====== QVector (åŒ…å«20æ¡)
       -Job1 {}
       -Job2 {}
       -Job3 {}
       -Job4 {}
       ....
       =====
       ====== QVector (åŒ…å«20æ¡)
       -Job21 {}
       -Job22 {}
       -Job23 {}
       -Job24 {}
       ....
       =====
==== åˆ†é¡µå

3. ç¬¬ä¸‰æ­¥
æ‰“å°ä¸Šé¢çš„å†…å®¹